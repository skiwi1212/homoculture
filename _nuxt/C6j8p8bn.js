import{_ as fe}from"./sNMN7HI-.js";import{c as pe}from"./Vtx-Ffg_.js";import{_ as ve}from"./BDbQtAMf.js";import{X as ne,r as N,d as H,K as he,L as V,H as W,j as A,w as L,g as R,J as r,Y as G,U as P,M as de,a4 as me,N as ge,Q as ye,z as xe,a3 as be,Z as Ce,e as D,h as F,n as w,$ as ke,F as le,G as Te,R as Ie,f as ae,t as Ee}from"./B0V24EwP.js";import{t as se}from"./M5iOQWe1.js";import{r as Se,u as ie,c as Ke,a as _e}from"./D2G85vdH.js";import{g as U,_ as we,M as Ae,u as Ve,a as Re}from"./BAQb-gFN.js";import{u as Be}from"./cWDgdZQ2.js";import{P as ce}from"./BIi6r2t3.js";import"./CMeV7kYO.js";import"./T18DsmPv.js";import"./Bxj6KYvj.js";import"./ClGykRXb.js";import"./D36rqGaW.js";function re(s,n,e){const o=e.originalEvent.target,C=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:e});n&&o.addEventListener(s,n,{once:!0}),o.dispatchEvent(C)}function Le(s){const n=Se("",1e3);return{search:n,handleTypeaheadSearch:(C,l)=>{n.value=n.value+C;{const d=U(),p=l.map(y=>{var S,b;return{...y,textValue:((S=y.value)==null?void 0:S.textValue)??((b=y.ref.textContent)==null?void 0:b.trim())??""}}),i=p.find(y=>y.ref===d),g=p.map(y=>y.textValue),K=Me(g,n.value,i==null?void 0:i.textValue),x=p.find(y=>y.textValue===K);return x&&x.ref.focus(),x==null?void 0:x.ref}},resetTypeahead:()=>{n.value=""}}}function $e(s,n){return s.map((e,o)=>s[(n+o)%s.length])}function Me(s,n,e){const C=n.length>1&&Array.from(n).every(g=>g===n[0])?n[0]:n,l=e?s.indexOf(e):-1;let d=$e(s,Math.max(l,0));C.length===1&&(d=d.filter(g=>g!==e));const i=d.find(g=>g.toLowerCase().startsWith(C.toLowerCase()));return i!==e?i:void 0}function j(s,n,e){const o=s.findIndex(p=>ne(p,n)),C=s.findIndex(p=>ne(p,e));if(o===-1||C===-1)return[];const[l,d]=[o,C].sort((p,i)=>p-i);return s.slice(l,d+1)}function Y(s){return s.reduce((n,e)=>(n.push(e),e.children&&n.push(...Y(e.children)),n),[])}function Ne(s,n){const e=N(),o=(l,d)=>{if(n.multiple&&Array.isArray(s.value))if(n.selectionBehavior==="replace")s.value=[l],e.value=l;else{const p=s.value.findIndex(i=>d(i));p!==-1?s.value.splice(p,1):s.value.push(l)}else n.selectionBehavior==="replace"?s.value={...l}:!Array.isArray(s.value)&&d(s.value)?s.value=void 0:s.value={...l};return s.value};function C(l,d,p,i){var y;if(!(e!=null&&e.value)||!n.multiple||!Array.isArray(s.value))return;const K=(y=p().filter(S=>S.ref.dataset.disabled!=="").find(S=>S.ref===d))==null?void 0:y.value;if(!K)return;let x=null;switch(l){case"prev":case"next":{x=j(i,e.value,K);break}case"first":{x=j(i,e.value,i==null?void 0:i[0]);break}case"last":{x=j(i,e.value,i==null?void 0:i[i.length-1]);break}}s.value=x}return{firstValue:e,onSelectItem:o,handleMultipleReplace:C}}const[De,Pe]=Ke("TreeRoot"),We=H({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:s=>s.children},selectionBehavior:{default:"toggle"},multiple:{type:Boolean},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(s,{emit:n}){const e=s,o=n,{items:C,multiple:l,disabled:d,propagateSelect:p,dir:i}=he(e),{handleTypeaheadSearch:g}=Le(),K=Be(i),x=N(),y=N(!1),S=_e(),b=ie(e,"modelValue",o,{defaultValue:e.defaultValue??(l.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),u=ie(e,"expanded",o,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:h,handleMultipleReplace:t}=Ne(b,e),c=V(()=>l.value&&Array.isArray(b.value)?b.value.map(a=>e.getKey(a)):[e.getKey(b.value??{})]);function f(a,v=1,I){return a.reduce((E,_,B)=>{const $=e.getKey(_),M=e.getChildren(_),z=u.value.includes($),O={_id:$,value:_,index:B,level:v,parentItem:I,hasChildren:!!M,bind:{value:_,level:v,"aria-setsize":a.length,"aria-posinset":B+1}};return E.push(O),M&&z&&E.push(...f(M,v+1,_)),E},[])}const m=V(()=>{const a=e.items;return u.value.map(v=>v),f(a??[])});function k(a){var v;if(y.value)S.trigger(a);else{const I=((v=x.value)==null?void 0:v.getItems())??[];g(a.key,I)}}function T(a){if(y.value)return;const v=Ae[a.key];me(()=>{var I;t(v,U(),(I=x.value)==null?void 0:I.getItems,m.value.map(E=>E.value))})}return Pe({modelValue:b,selectedKeys:c,onSelect:a=>{var E;const v=_=>e.getKey(_??{})===e.getKey(a),I=e.multiple&&Array.isArray(b.value)?((E=b.value)==null?void 0:E.findIndex(v))!==-1:void 0;if(h(a,v),e.propagateSelect&&e.multiple&&Array.isArray(b.value)){const _=Y(e.getChildren(a)??[]);I?b.value=[...b.value].filter(B=>!_.some($=>e.getKey(B??{})===e.getKey($))):b.value=[...b.value,..._]}},expanded:u,onToggle(a){if(!(a?e.getChildren(a):void 0))return;const I=e.getKey(a)??a;u.value.includes(I)?u.value=u.value.filter(E=>E!==I):u.value.push(I)},getKey:e.getKey,getChildren:e.getChildren,items:C,expandedItems:m,disabled:d,multiple:l,dir:K,propagateSelect:p,isVirtual:y,virtualKeydownHook:S,handleMultipleReplace:t}),(a,v)=>(A(),W(r(we),{ref_key:"rovingFocusGroupRef",ref:x,"as-child":"",orientation:"vertical",dir:r(K)},{default:L(()=>[R(r(ce),{role:"tree",as:a.as,"as-child":a.asChild,"aria-multiselectable":r(l)?!0:void 0,onKeydown:[k,G(P(T,["shift"]),["up","down"])]},{default:L(()=>[de(a.$slots,"default",{flattenItems:m.value,modelValue:r(b),expanded:r(u)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),ze="tree.select",Oe="tree.toggle",Fe=H({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(s,{expose:n,emit:e}){const o=s,C=e,l=De(),{getItems:d}=Ve(),p=V(()=>!!l.getChildren(o.value)),i=V(()=>{const t=l.getKey(o.value);return l.expanded.value.includes(t)}),g=V(()=>{const t=l.getKey(o.value);return l.selectedKeys.value.includes(t)}),K=V(()=>{if(l.propagateSelect.value&&g.value&&p.value&&Array.isArray(l.modelValue.value))return!Y(l.getChildren(o.value)||[]).every(c=>l.modelValue.value.find(f=>l.getKey(f)===l.getKey(c)))});function x(t){if(p.value)if(i.value){const c=d().map(a=>a.ref),f=U(),m=c.indexOf(f),T=[...c].slice(m).find(a=>Number(a.getAttribute("data-indent"))===o.level+1);T&&T.focus()}else h(t)}function y(t){if(i.value)h(t);else{const c=d().map(a=>a.ref),f=U(),m=c.indexOf(f),T=[...c].slice(0,m).reverse().find(a=>Number(a.getAttribute("data-indent"))===o.level-1);T&&T.focus()}}async function S(t){C("select",t),!(t!=null&&t.defaultPrevented)&&l.onSelect(o.value)}async function b(t){C("toggle",t),!(t!=null&&t.defaultPrevented)&&l.onToggle(o.value)}async function u(t){if(!t)return;const c={originalEvent:t,value:o.value,isExpanded:i.value,isSelected:g.value};re(ze,S,c)}async function h(t){if(!t)return;const c={originalEvent:t,value:o.value,isExpanded:i.value,isSelected:g.value};re(Oe,b,c)}return n({isExpanded:i,isSelected:g,isIndeterminate:K,handleToggle:()=>l.onToggle(o.value),handleSelect:()=>l.onSelect(o.value)}),(t,c)=>(A(),W(r(Re),{"as-child":"",value:t.value,"allow-shift-key":""},{default:L(()=>[R(r(ce),ge(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":g.value,"aria-expanded":p.value?i.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":g.value?"":void 0,"data-expanded":i.value?"":void 0,onKeydown:[G(P(u,["self","prevent"]),["enter","space"]),c[0]||(c[0]=G(P(f=>r(l).dir.value==="ltr"?x(f):y(f),["prevent"]),["right"])),c[1]||(c[1]=G(P(f=>r(l).dir.value==="ltr"?y(f):x(f),["prevent"]),["left"]))],onClick:c[2]||(c[2]=P(f=>{u(f),h(f)},["stop"]))}),{default:L(()=>[de(t.$slots,"default",{isExpanded:i.value,isSelected:g.value,isIndeterminate:K.value,handleSelect:()=>r(l).onSelect(t.value),handleToggle:()=>r(l).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),Ge={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-(--ui-border-muted) rounded-[calc(var(--ui-radius)*1.5)]",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-(--ui-border-muted) overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-(--ui-border)",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-[calc(var(--ui-radius)*1.5)] focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-(--ui-text-highlighted) before:bg-(--ui-bg-elevated)"},false:{link:["hover:text-(--ui-text-highlighted) hover:before:bg-(--ui-bg-elevated)/50","transition-colors before:transition-colors"]}}}},Ue=Ie;var oe,ue;const je=se({extend:se(Ge),...((ue=(oe=Ue.uiPro)==null?void 0:oe.prose)==null?void 0:ue.codeTree)||{}}),rt=H({__name:"CodeTree",props:{defaultValue:{},class:{},ui:{}},setup(s){const n=s,e=ye(),o=xe(),[C,l]=pe(),d=je(),p=N(n.defaultValue?{path:n.defaultValue}:void 0),i=N(),g=N(1),K=V(()=>{var u,h;return g.value,((h=(u=e.default)==null?void 0:u.call(e))==null?void 0:h.flatMap(S).filter(Boolean))||[]}),x=V(()=>y(K.value));function y(u){const h=new Map,t=[];u.forEach(f=>{const m=f.label.split("/");let k="";m.forEach((T,a)=>{var v,I;if(k=k?`${k}/${T}`:T,!h.has(k)){const E={label:T,path:k,...a<m.length-1&&{children:[]}};h.set(k,E),a===0?t.push(E):(I=(v=h.get(m.slice(0,a).join("/")))==null?void 0:v.children)==null||I.push(E)}})});const c=f=>f.sort((m,k)=>!!m.children==!!k.children?m.label.localeCompare(k.label):k.children?1:-1).map(m=>({...m,children:m.children&&c(m.children)}));return c(t)}function S(u,h){var t,c,f,m;return typeof u.type=="symbol"?(t=u.children)==null?void 0:t.map(S):{label:((c=u.props)==null?void 0:c.filename)||((f=u.props)==null?void 0:f.label)||`${h}`,icon:(m=u.props)==null?void 0:m.icon,component:u}}const b=V(()=>{var t;const u=(t=p.value)==null?void 0:t.path;if(!u)return[];const h=u.split("/");return h.map((c,f)=>h.slice(0,f+1).join("/"))});return be(p,u=>{const h=K.value.find(t=>(u==null?void 0:u.path)===t.label);h!=null&&h.component&&(i.value=h)},{immediate:!0}),Ce(()=>g.value++),(u,h)=>{var c,f,m,k;const t=fe;return A(),D(le,null,[R(r(C),null,{default:L(({items:T,level:a})=>[(A(!0),D(le,null,Te(T,(v,I)=>{var E,_;return A(),D("li",{key:`${a}-${I}`,class:w(a>0?r(d).itemWithChildren({class:(E=n.ui)==null?void 0:E.itemWithChildren}):r(d).item({class:(_=n.ui)==null?void 0:_.item}))},[R(r(Fe),{"as-child":"",level:a,value:v},{default:L(({isExpanded:B,isSelected:$})=>{var M,z,O,q,J,Q,X,Z,ee,te;return[F("button",{class:w(r(d).link({class:(M=n.ui)==null?void 0:M.link,active:$}))},[(z=v.children)!=null&&z.length?(A(),W(t,{key:0,name:B?r(o).ui.icons.folderOpen:r(o).ui.icons.folder,class:w(r(d).linkLeadingIcon({class:(O=n.ui)==null?void 0:O.linkLeadingIcon}))},null,8,["name","class"])):(A(),W(ve,{key:1,filename:v.label,class:w(r(d).linkLeadingIcon({class:(q=n.ui)==null?void 0:q.linkLeadingIcon}))},null,8,["filename","class"])),F("span",{class:w(r(d).linkLabel({class:(J=n.ui)==null?void 0:J.linkLabel}))},Ee(v.label),3),(Q=v.children)!=null&&Q.length?(A(),D("span",{key:2,class:w(r(d).linkTrailing({class:(X=n.ui)==null?void 0:X.linkTrailing}))},[R(t,{name:r(o).ui.icons.chevronDown,class:w(r(d).linkTrailingIcon({class:(Z=n.ui)==null?void 0:Z.linkTrailingIcon}))},null,8,["name","class"])],2)):ae("",!0)],2),(ee=v.children)!=null&&ee.length&&B?(A(),D("ul",{key:0,class:w(r(d).listWithChildren({class:(te=n.ui)==null?void 0:te.listWithChildren}))},[R(r(l),{items:v.children,level:a+1},null,8,["items","level"])],2)):ae("",!0)]}),_:2},1032,["level","value"])],2)}),128))]),_:1}),F("div",{class:w(r(d).root({class:[n.class,(c=n.ui)==null?void 0:c.root]}))},[R(r(We),{modelValue:p.value,"onUpdate:modelValue":h[0]||(h[0]=T=>p.value=T),class:w(r(d).list({class:(f=n.ui)==null?void 0:f.list})),items:x.value,"get-key":T=>T.path,"default-expanded":b.value},{default:L(()=>[R(r(l),{items:x.value,level:0},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),F("div",{class:w(r(d).content({class:(m=n.ui)==null?void 0:m.content}))},[(A(),W(ke((k=i.value)==null?void 0:k.component)))],2)],2)],64)}}});export{rt as default};
